spring:
  application:
    name: todo-app-spring

  profiles:
    active: ${SPRING_PROFILES_ACTIVE:dev}

  datasource:
    url: ${SPRING_DATABASE_URL:jdbc:postgresql://localhost:5434/todo_spring_dev}
    username: ${SPRING_DATABASE_USER:todo_user}
    password: ${SPRING_DATABASE_PASSWORD:todo_password_dev}
    driver-class-name: org.postgresql.Driver
    hikari:
      minimum-idle: ${DATABASE_POOL_MIN:2}
      maximum-pool-size: ${DATABASE_POOL_MAX:10}
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000
      pool-name: TodoAppHikariPool

  flyway:
    enabled: true
    baseline-on-migrate: true
    locations: classpath:db/migration
    sql-migration-prefix: V
    sql-migration-separator: __
    sql-migration-suffixes: .sql

  jooq:
    sql-dialect: postgres

  security:
    filter:
      order: 5

server:
  port: ${SPRING_PORT:9000}
  error:
    include-message: always
    include-binding-errors: always
    include-stacktrace: on_param
  servlet:
    context-path: /

# Application Configuration
app:
  base-url: ${APP_BASE_URL:http://localhost:9000}

  jwt:
    access-secret: ${JWT_ACCESS_SECRET:6Tjy9M82RkzGInTX5N+1C4KiwmchDMxjREdXBObq5Nc=}
    refresh-secret: ${JWT_REFRESH_SECRET:22xvVywJLQj7OUlBxNVeY+1/Z3LhvqWTQCFA7VgpNzc=}
    access-expiry: ${JWT_ACCESS_EXPIRY:15m}
    refresh-expiry: ${JWT_REFRESH_EXPIRY:7d}

  cors:
    allowed-origins: ${CORS_ALLOWED_ORIGINS:http://localhost:4000,http://localhost:3000,http://localhost:3001,http://localhost:4200,http://localhost:4400}

  email:
    from: ${EMAIL_FROM:admin@zatvia.com}
    from-name: ${EMAIL_FROM_NAME:TodoApp}
    reply-to: ${EMAIL_REPLY_TO:admin@zatvia.com}

  sendgrid:
    api-key: ${SENDGRID_API_KEY:}

  oauth:
    state-secret: ${API_SERVER_OAUTH_KEY:123456789012345}
    state-expiry-seconds: 300

    google:
      client-id: ${GOOGLE_OAUTH_CLIENT_ID:}
      client-secret: ${GOOGLE_OAUTH_CLIENT_SECRET:}
      authorization-endpoint: https://accounts.google.com/o/oauth2/v2/auth
      token-endpoint: https://oauth2.googleapis.com/token

    microsoft:
      client-id: ${MS_OAUTH_CLIENT_ID:}
      client-secret: ${MS_OAUTH_CLIENT_SECRET:}
      authorization-endpoint: https://login.microsoftonline.com/common/oauth2/v2.0/authorize
      token-endpoint: https://login.microsoftonline.com/common/oauth2/v2.0/token

# Actuator Configuration
management:
  endpoints:
    web:
      exposure:
        include: health,readiness,info,metrics,prometheus
      base-path: /
  endpoint:
    health:
      show-details: when-authorized
      probes:
        enabled: true
  health:
    livenessState:
      enabled: true
    readinessState:
      enabled: true
  metrics:
    export:
      prometheus:
        enabled: true

# Logging
logging:
  level:
    root: ${LOG_LEVEL:INFO}
    com.todoapp: ${LOG_LEVEL:DEBUG}
    org.springframework.security: ${LOG_LEVEL:INFO}
    org.jooq: ${LOG_LEVEL:INFO}
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"

# SpringDoc OpenAPI
springdoc:
  api-docs:
    path: /v3/api-docs
  swagger-ui:
    path: /swagger-ui.html
    tags-sorter: alpha
    operations-sorter: alpha
  show-actuator: true
